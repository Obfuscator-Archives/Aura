using dnlib.DotNet;
using System;
using System.Collections.Generic;
using System.Linq;

namespace Aura.Protection.Renamer
{
    public class RenamerPhase
    {
        private static readonly Dictionary<TypeDef, bool> TypeRename = new Dictionary<TypeDef, bool>();
        private static readonly List<string> TypeNewName = new List<string>();
        private static readonly Dictionary<MethodDef, bool> MethodRename = new Dictionary<MethodDef, bool>();
        private static readonly List<string> MethodNewName = new List<string>();
        private static readonly Dictionary<FieldDef, bool> FieldRename = new Dictionary<FieldDef, bool>();
        private static readonly List<string> FieldNewName = new List<string>();
        public static bool IsObfuscationActive = true;

        public static void Execute(ModuleDefMD module)
        {
            if (IsObfuscationActive)
            {
                //                var namespaceNewName = GenerateString(RenameMode.Normal);
                foreach (var type in module.Types)
                {
                    if (TypeRename.TryGetValue(type, out var canRenameType))
                    {
                        if (canRenameType && type.IsSerializable)
                            InternalRename(type);
                    }
                    else
                        InternalRename(type);
                    foreach (var method in type.Methods)
                    {
                        if (MethodRename.TryGetValue(method, out var canRenameMethod))
                        {
                            if (canRenameMethod && !method.IsConstructor && !method.IsSpecialName)
                                InternalRename(method);
                        }
                        else
                            InternalRename(method);
                    }
                    MethodNewName.Clear();
                    foreach (var field in type.Fields)
                    {
                        if (FieldRename.TryGetValue(field, out var canRenameField))
                        {
                            if (canRenameField)
                                InternalRename(field);
                        }
                        else
                            InternalRename(field);
                    }
                    FieldNewName.Clear();
                }
            }
            else
            {
                foreach (var typeItem in TypeRename.Where(typeItem => typeItem.Value))
                {
                    InternalRename(typeItem.Key);
                }
                foreach (var methodItem in MethodRename.Where(methodItem => methodItem.Value))
                {
                    InternalRename(methodItem.Key);
                }
                foreach (var fieldItem in FieldRename.Where(fieldItem => fieldItem.Value))
                {
                    InternalRename(fieldItem.Key);
                }
            }
        }

        private static void InternalRename(TypeDef type)
        {
            var randString = GenerateString(RenameMode.Normal);
            while (TypeNewName.Contains(randString))
                randString = GenerateString(RenameMode.Normal);
            TypeNewName.Add(randString);
            type.Name = randString;
        }

        private static void InternalRename(MethodDef method)
        {
            var randString = GenerateString(RenameMode.Normal);
            while (MethodNewName.Contains(randString))
                randString = GenerateString(RenameMode.Normal);
            MethodNewName.Add(randString);
            method.Name = randString;
        }

        private static void InternalRename(FieldDef field)
        {
            var randString = GenerateString(RenameMode.Normal);
            while (FieldNewName.Contains(randString))
                randString = GenerateString(RenameMode.Normal);
            FieldNewName.Add(randString);
            field.Name = randString;
        }

        public static Random Random = new Random();

        private static string RandomString(int length)
        {
            string chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()-_+=[{}]|;:',<.>/?";
            return new string(Enumerable.Repeat(chars, length).Select(s => s[Random.Next(s.Length)]).ToArray());
        }

        public enum RenameMode
        {
            Ascii,
            Normal
        }

        public static string[] NormalNameStrings = {
            RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString(), RandomString(10).ToString()
        };

        public static string GetRandomName()
        {
            return NormalNameStrings[Random.Next(NormalNameStrings.Length)];
        }

        public static string Ascii = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()-_+=[{}]|;:',<.>/?";

        public static string GenerateString(RenameMode mode)
        {
            switch (mode)
            {
                case RenameMode.Ascii:
                    return GetRandomName();

                case RenameMode.Normal:
                    return GetRandomName();

                default:
                    throw new ArgumentOutOfRangeException(nameof(mode), mode, null);
            }
        }
    }
}